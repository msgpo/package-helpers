#/bin/sh
#
#    Copyright (C) 2008-2016  Rubén Rodríguez <ruben@trisquel.info>
#
#    This program is free software; you can redistribute it and/or modify
#    it under the terms of the GNU General Public License as published by
#    the Free Software Foundation; either version 2 of the License, or
#    (at your option) any later version.
#
#    This program is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU General Public License for more details.
#
#    You should have received a copy of the GNU General Public License
#    along with this program; if not, write to the Free Software
#    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
#

VERSION=1
QUILT=skip
. ./config

export QUILT_PATCHES=debian/patches
quilt push -a

cp $DATA/plymouth-theme-trisquel-logo* debian

sed '/ttf-ubuntu-font-family/d' -i debian/control

cat << EOF >> debian/copyright

== Additions made by Trisquel ==

themes/script/taranis.png Copyright (C) 2010 Rubén Rodríguez, GPL-3 license
themes/script/trisquel_logo16.png Copyright (C) 2004-2011 Rubén Rodríguez, GPL-3 license
EOF

find -type d |xargs rename s/kubuntu/trisquel-mini/g
find -type f |xargs rename s/kubuntu/trisquel-mini/g
find -type d |xargs rename s/ubuntu/trisquel/g
find -type f |xargs rename s/ubuntu/trisquel/g

replace kubuntu-text trisquel-mini-text .
replace kubuntu_text trisquel_mini_text .
replace kubuntu-logo trisquel-mini-logo .
replace kubuntu_logo trisquel_mini_logo .
replace ubuntu-logo trisquel-logo .
replace ubuntu_logo trisquel_logo .
replace ubuntu-text trisquel-text .
replace ubuntu_text trisquel_text .
replace ubuntu_details trisquel_details .
replace "Name=Kubuntu" "Name=Trisquel-mini" .
replace "Name=Ubuntu" "Name=Trisquel" .
replace "Ubuntu 11.04" "Trisquel $REVISION" .
replace "Ubuntu 10.04" "Trisquel $REVISION" .
replace "Ubuntu 10.10" "Trisquel $REVISION" .
replace "Kubuntu 10.10" "Trisquel mini $REVISION" .
replace 2c001e 000000 .
replace ff4012 0051FF .


cp $DATA/*.png themes/script
cp $DATA/script.script themes/script/script.script

cat << EOF > debian/source/include-binaries
themes/script/background.png
themes/script/trisquel_logo16.png
EOF

rm themes/trisquel-logo -rf
cp themes/script -a themes/trisquel-logo
cp $DATA/background.png themes/trisquel-logo/
cp $DATA/trisquel_logo16.png themes/trisquel-logo/trisquel-logo.png
sed -i 's/progress_bar.png/progress_bar.png\\\n\t\tbackground.png\\\n\t\ttrisquel_logo16.png/' themes/trisquel-logo/Makefile*
sed s:/script:/trisquel-logo:g -i themes/trisquel-logo/script.plymouth.in
sed 's:=Script:=Trisquel-logo:g' -i themes/trisquel-logo/script.plymouth.in
sed 's/script\.script/trisquel-logo\.rtoken/g' -i themes/trisquel-logo/Make*
sed 's/script/trisquel-logo/g' -i themes/trisquel-logo/Make*
sed 's/rtoken/script/g' -i themes/trisquel-logo/Make*
rename s/script.script/trisquel-logo.script/g themes/trisquel-logo/*
rename s/script.plymouth.in/trisquel-logo.plymouth.in/g themes/trisquel-logo/*

sed s/Ubuntu/Trisquel/ -i debian/plymouth-theme-trisquel-text.postinst

changelog "Plymouth themes modified for Trisquel"

compile

